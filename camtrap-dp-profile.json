{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Camera Trap Data Package",
  "description": "Data exchange format for camera trap data. https://tdwg.github.io/camtrap-dp/",
  "type": "object",
  "$defs": {
    "version": {
      "pattern": "0\\.3"
    }
  },  
  "allOf": [
    {
      "$ref": "https://frictionlessdata.io/schemas/data-package.json"
    },
    {
      "required": [
        "profile",
        "created",
        "contributors",
        "project",
        "spatial",
        "temporal",
        "taxonomic"
      ],
      "properties": {
        "resources": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#resource-information). Camtrap DP further requires each object to be a [Tabular Data Resource](https://specs.frictionlessdata.io/tabular-data-resource/) with a specific `name` and `schema`. See [Data](../data) for the requirements for those resources.",
          "minItems": 3,
          "maxItems": 3,
          "items": {
            "required": [
              "schema",
              "profile"
            ],
            "properties": {
              "name": {
                "description": "Identifier of the resource.",
                "enum": [
                  "deployments",
                  "media",
                  "observations"
                ]
              },
              "profile": {
                "const": "tabular-data-resource"
              },
              "schema": {
                "description": "URL of the used Camtrap DP Table Schema version (e.g. `https://raw.githubusercontent.com/tdwg/camtrap-dp/1.0/deployments-table-schema.json`).",
                "$ref": "#$defs/version",
                "required": [
                  "name"
                ],
                "properties": {
                  "name": {
                    "enum": [
                      "deployments",
                      "media",
                      "observations"
                    ]
                  }
                }
              }
            }
          }
        },
        "profile": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#profile). Camtrap DP further requires this to be the URL of the used Camtrap DP Profile version (e.g. `https://raw.githubusercontent.com/tdwg/camtrap-dp/1.0/camtrap-dp-profile.json`).",
          "format": "uri"
        },
        "name": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#name)."
        },
        "id": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#id)."
        },
        "created": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#created). Camtrap DP makes this a required property."
        },
        "title": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#title). Not to be confused with the title of the project that originated the package (`package.project.title`)."
        },
        "contributors": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#contributors). Camtrap DP makes this a required property. Can include people and organizations."
        },
        "description": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#description). Not to be confused with the description of the project that originated the package (`package.project.description`)."
        },
        "version": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#version)."
        },
        "keywords": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#keywords)."
        },
        "image": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#image)."
        },
        "homepage": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#homepage)."
        },
        "sources": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#sources). Can include the data management platform from which the package was derived (e.g. Agouti, Trapper, Wildlife Insights).",
          "items": {
            "properties": {
              "version": {
                "description": "Version of the source.",
                "type": "string"
              }
            }
          }
        },
        "licenses": {
          "description": "See [Data Package specification](https://specs.frictionlessdata.io/data-package/#licenses). If provided, Camtrap DP further requires at least a license for the content of the package and one for the media files.",
          "minItems": 2,
          "items": {
            "required": [
              "scope"
            ],
            "properties": {
              "scope": {
                "description": "Scope of the license. `data` applies to the content of the package and resources, `media` to the (locally or externally hosted) media files referenced in `media.filePath`.",
                "type": "string",
                "enum": [
                  "data",
                  "media"
                ] 
              }
            }
          }
        },
        "bibliographicCitation": {
          "description": "Bibliographic/recommended citation for the package.",
          "skos:exactMatch": "http://purl.org/dc/terms/bibliographicCitation",
          "type": "string"
        },
        "project": {
          "description": "Camera trap project or study that originated the package.",
          "type": "object",
          "required": [
            "title",
            "samplingDesign",
            "captureMethod",
            "individualAnimals",
            "classificationLevel",
            "sequenceInterval"
          ],
          "properties": {
            "id": {
              "description": "Unique identifier of the project.",
              "type": "string"
            },
            "title": {
              "description": "Title of the project. Not to be confused with the title of the package (`package.title`).",
              "type": "string"
            },
            "acronym": {
              "description": "Project acronym.",
              "type": "string"
            },
            "description": {
              "description": "Description of the project, ideally [Markdown](http://commonmark.org/) formatted. Not to be confused with the description of the package (`package.description`).",
              "type": "string"
            },
            "path": {
              "description": "Project website.",
              "type": "string",
              "format": "uri"
            },
            "samplingDesign": {
              "description": "Type of a sampling design/layout. The values are based on Wearn & Glover-Kapfer (2017, <https://doi.org/10.13140/RG.2.2.23409.17767>), pages 80-82: `simple random`: random distribution of sampling locations; `systematic random`: random distribution of sampling locations, but arranged in a regular pattern; `clustered random`: random distribution of sampling locations, but clustered in arrays; `experimental`: non-random distribution aimed to study an effect, including the before-after control-impact (BACI) design; `targeted`: non-random distribution optimized for capturing specific target species (often using various bait types); `opportunistic`: opportunistic camera trapping (usually with a small number of cameras).",
              "type": "string",
              "enum": [
                "simple random",
                "systematic random",
                "clustered random",
                "experimental",
                "targeted",
                "opportunistic"
              ]
            },
            "captureMethod": {
              "description": "Method(s) used to capture the media files.",
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "motion detection",
                  "time lapse"
                ]
              },
              "uniqueItems": true,
              "minItems": 1
            },
            "individualAnimals": {
              "description": "`true` if the project includes marked or recognizable individuals. See also `observations.individualID`.",
              "type": "boolean"
            },
            "classificationLevel": {
              "description": "Information about a focal level of the classification process. `sequence`: classifications (i.e. rows in the `observations` resource) are provided at a sequence level (multiple media files can be part of one sequence); `media`: classifications are available for each single media file.",
              "type": "string",
              "enum": [
                "sequence",
                "media"
              ]
            },
            "sequenceInterval": {
              "description": "Maximum number of seconds between timestamps of successive media files to be considered part of a single sequence and be assigned the same `media.sequenceID`.",
              "type": "integer"
            }
          }
        },
        "coordinatePrecision": {
          "description": "Minimum precision of the `deployments.latitude` and `deployments.longitude` (e.g. `0.001` for a minimum precision of 0.001 degree). Especially relevant when coordinates are rounded to protect sensitive species.",
          "skos:exactMatch": "http://rs.tdwg.org/dwc/terms/coordinatePrecision",
          "type": "number",
          "example": 0.001
        },
        "spatial": {
          "description": "Spatial coverage of the package, expressed as GeoJSON.",
          "skos:exactMatch": "http://purl.org/dc/terms/spatial",
          "type": "object",
          "$ref": "http://json.schemastore.org/geojson.json"
        },
        "temporal": {
          "description": "Temporal coverage of the package.",
          "skos:exactMatch": "http://purl.org/dc/terms/temporal",
          "type": "object",
          "required": [
            "start",
            "end"
          ],
          "properties": {
            "start": {
              "description": "Start date of the first deployment, as an ISO 8601 formatted string (`YYYY-MM-DD`).",
              "type": "string",
              "format": "date"
            },
            "end": {
              "description": "End date of the last (completed) deployment, as an ISO 8601 formatted string (`YYYY-MM-DD`).",
              "type": "string",
              "format": "date"
            }
          }
        },
        "taxonomic": {
          "description": "Taxonomic coverage of the package, based on the unique `observations.scientificName`.",
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "taxonID",
              "taxonIDReference",
              "scientificName"
            ],
            "properties": {
              "taxonID": {
                "description": "Unique identifier of the taxon according to the taxonomic reference list defined by `taxonIDReference`.",
                "skos:exactMatch": "http://rs.tdwg.org/dwc/terms/taxonID",
                "type": "string",
                "example": "QLXL"
              },
              "taxonIDReference": {
                "description": "URL of the source (reference list) of the `taxonID`.",
                "type": "string",
                "format": "uri",
                "example": "https://www.catalogueoflife.org"
              },
              "scientificName": {
                "description": "Scientific name of the taxon.",
                "skos:exactMatch": "http://rs.tdwg.org/dwc/terms/scientificName",
                "type": "string",
                "example": "Canis lupus"
              },
              "taxonRank": {
                "description": "Taxonomic rank of the scientific name.",
                "skos:exactMatch": "http://rs.tdwg.org/dwc/terms/taxonRank",
                "type": "string",
                "enum": [
                  "kingdom",
                  "phylum",
                  "class",
                  "order",
                  "family",
                  "genus",
                  "species",
                  "subspecies"
                ],
                "example": "species"
              },
              "kingdom": {
                "description": "Kingdom in which the taxon is classified.",
                "skos:exactMatch": "http://rs.tdwg.org/dwc/terms/kingdom",
                "type": "string",
                "example": "Animalia"
              },
              "phylum": {
                "description": "Phylum or division in which the taxon is classified",
                "skos:exactMatch": "http://rs.tdwg.org/dwc/terms/phylum",
                "type": "string",
                "example": "Chordata"
              },
              "class": {
                "description": "Class in which the taxon is classified.",
                "skos:exactMatch": "http://rs.tdwg.org/dwc/terms/class",
                "type": "string",
                "example": "Mammalia"
              },
              "order": {
                "description": "Order in which the taxon is classified.",
                "skos:exactMatch": "http://rs.tdwg.org/dwc/terms/order",
                "type": "string",
                "example": "Carnivora"
              },
              "family": {
                "description": "Family in which the taxon is classified.",
                "skos:exactMatch": "http://rs.tdwg.org/dwc/terms/family",
                "type": "string",
                "example": "Canidae"
              },
              "genus": {
                "description": "Genus in which the taxon is classified.",
                "skos:exactMatch": "http://rs.tdwg.org/dwc/terms/genus",
                "type": "string",
                "example": "Canis"
              },
              "vernacularNames": {
                "description": "Common or vernacular names of the taxon, as `languageCode: vernacular name` pairs. Language codes should follow ISO 639-1 (e.g. `en` for English).",
                "type": "object",
                "patternProperties": {
                  "^[a-z]{2}$": {
                    "description": "Common or vernacular name of the taxon in that language.",
                    "skos:exactMatch": "http://rs.tdwg.org/dwc/terms/vernacularName",
                    "type": "string"                    
                  }
                },
                "additionalProperties": false,
                "example": "{'en': 'wolf', 'fr': 'loup gris'}"
              }
            }
          }
        },
        "references": {
          "description": "List of references related to the package (e.g. references cited in `package.project.description`). References ideally include a DOI.",
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    }
  ]
}
